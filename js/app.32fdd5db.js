(function(e){function t(t){for(var r,a,o=t[0],c=t[1],l=t[2],p=0,d=[];p<o.length;p++)a=o[p],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&d.push(i[a][0]),i[a]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);u&&u(t);while(d.length)d.shift()();return s.push.apply(s,l||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],r=!0,o=1;o<n.length;o++){var c=n[o];0!==i[c]&&(r=!1)}r&&(s.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},i={app:0},s=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="spotify-playlist-creater/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var u=c;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"126a":function(e,t,n){},"21f1":function(e,t,n){"use strict";var r=n("9e4c"),i=n.n(r);i.a},2531:function(e,t,n){"use strict";var r=n("126a"),i=n.n(r);i.a},3086:function(e,t,n){},4792:function(e,t,n){"use strict";var r=n("db73"),i=n.n(r);i.a},"56d7":function(e,t,n){"use strict";n.r(t);n("b0c0"),n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),i=n("8c4f"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",{attrs:{id:"progress-bar"}}),n("router-view")],1)},a=[],o={name:"App"},c=o,l=(n("5c0b"),n("2877")),u=Object(l["a"])(c,s,a,!1,null,null,null),p=u.exports,d=n("e009"),f=n("2f62"),m=(n("caad"),n("07ac"),n("2532"),{spotifyApi:{mode:Object({VUE_APP_BASE_PATH:"spotify-playlist-creater/",NODE_ENV:"production",BASE_URL:"spotify-playlist-creater/"}).VUE_APP_SPOTIFY_API_MODE,modes:{DEV:"development",PROXY:"proxy"},baseUrl:"https://api.spotify.com/v1",secrets:{clientId:Object({VUE_APP_BASE_PATH:"spotify-playlist-creater/",NODE_ENV:"production",BASE_URL:"spotify-playlist-creater/"}).VUE_APP_SPOTIFY_API_CLIENT_ID,clientSecret:Object({VUE_APP_BASE_PATH:"spotify-playlist-creater/",NODE_ENV:"production",BASE_URL:"spotify-playlist-creater/"}).VUE_APP_SPOTIFY_API_CLIENT_SECRET},isSaveTokensEnabled:"true"===Object({VUE_APP_BASE_PATH:"spotify-playlist-creater/",NODE_ENV:"production",BASE_URL:"spotify-playlist-creater/"}).VUE_APP_SPOTIFY_API_SAVE_TOKENS.toLowerCase()}}),h=m.spotifyApi;Object.values(h.modes).includes(h.mode)||console.error("Invalid api mode in config!"),h.mode===h.modes.DEV&&(void 0===h.secrets.clientId&&console.error("No client id specified in dev mode!"),void 0===h.secrets.clientSecret&&console.error("No client secret specified in dev mode!"));var v,y=m,_="spotifyAccessToken",b="spotifyTokenExpiry",g={state:{spotifyAccessToken:localStorage.getItem(_),spotifyTokenExpiration:localStorage.getItem(b)},mutations:{setSpotifyAccessToken:function(e,t){y.spotifyApi.isSaveTokensEnabled&&(localStorage.setItem(_,t.accessToken),localStorage.setItem(b,t.expirationDate)),e.spotifyAccessToken=t.accessToken,e.spotifyTokenExpiration=t.expirationDate},invalidateSpotifyAccessToken:function(e){localStorage.removeItem(_),localStorage.removeItem(b),e.spotifyAccessToken=null,e.spotifyTokenExpiration=null}},actions:{},getters:{spotifyAccessToken:function(e){return e.spotifyAccessToken},spotifyTokenExpiry:function(e){return e.spotifyTokenExpiration},isAuthenticated:function(e){return null!=e.spotifyAccessToken&&e.spotifyTokenExpiration>(new Date).getTime()}}},k=(n("4fad"),n("ade3")),w={state:{selectedPlaylists:{}},mutations:{changeSelectPlaylistState:function(e,t){void 0!==e.selectedPlaylists[t.id]?r["a"].delete(e.selectedPlaylists,t.id):r["a"].set(e.selectedPlaylists,t.id,t)}},getters:{getSelectedPlaylists:function(e){return e.selectedPlaylists},isPlaylistSelected:function(e){return function(t){return void 0!==e.selectedPlaylists[t]}}}},S=["CHOOSE_SOURCE","ANALYSIS"],A=(v={},Object(k["a"])(v,S[0],(function(e,t){return Object.entries(t.getSelectedPlaylists).length>0})),Object(k["a"])(v,S[1],(function(e){return console.log(e),!0})),v),P={modules:{source:w},getters:{isStepValid:function(e,t){return function(n){if(void 0===A[n])throw new Error("No validator defined for specified step!");return A[n](e,t)}}}};r["a"].use(f["a"]);var x=new f["a"].Store({modules:{auth:g,steps:P},state:{isLoading:!1},mutations:{startLoading:function(e){e.isLoading=!0},finishLoading:function(e){e.isLoading=!1}},actions:{},getters:{isLoading:function(e){return e.isLoading}}}),E=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"login-page"}},[n("div",{attrs:{id:"container"}},[n("h1",[e._v("Spoti.fish")]),n("img",{attrs:{id:"logo",src:"https://placeholder.pics/svg/300",alt:"Spoti.fish Icon"}}),n("button",{attrs:{id:"btn-login"},on:{click:e.login}},[e._v("Login with Spotify")])])])},O=[],T=(n("96cf"),n("1da1")),j=(n("d3b7"),n("25f0"),n("3ca3"),n("ddb0"),n("2b3d"),function(){var e=Object(T["a"])(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return void 0===n.headers&&(n.headers={}),n.headers["Authorization"]="Bearer "+x.getters.spotifyAccessToken,e.next=4,fetch(y.spotifyApi.baseUrl+t,n);case 4:if(r=e.sent,401!==r.status){e.next=10;break}x.commit("invalidateSpotifyAccessToken"),window.location.href="/",e.next=15;break;case 10:if(!r.ok){e.next=14;break}return e.abrupt("return",r.json());case 14:throw new Error("Error while accessing spotify api: "+r.status);case 15:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),C="/me/playlists";function I(){return R.apply(this,arguments)}function R(){return R=Object(T["a"])(regeneratorRuntime.mark((function e(){var t,n,r,i=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:20,n=i.length>1&&void 0!==i[1]?i[1]:0,r=new URLSearchParams({limit:t,offset:n}),e.abrupt("return",j(C+"?"+r.toString(),{method:"GET"}));case 4:case"end":return e.stop()}}),e)}))),R.apply(this,arguments)}var $={getCurrentUserPlaylists:I};function L(e,t,n){var r=new URLSearchParams({client_id:y.spotifyApi.secrets.clientId,response_type:"code",redirect_uri:e,state:t});void 0!==n&&r.set("scope",n),location.href="https://accounts.spotify.com/authorize?"+r.toString()}function U(e,t){return N.apply(this,arguments)}function N(){return N=Object(T["a"])(regeneratorRuntime.mark((function e(t,n){var r,i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=new URLSearchParams({grant_type:"authorization_code",code:n,redirect_uri:t}),null==y.spotifyApi.secrets.clientSecret){e.next=17;break}return r.set("client_id",y.spotifyApi.secrets.clientId),r.set("client_secret",y.spotifyApi.secrets.clientSecret),e.next=6,fetch("https://accounts.spotify.com/api/token",{method:"POST",body:r,headers:{"Content-Type":"application/x-www-form-urlencoded"}});case 6:if(i=e.sent,!i.ok){e.next=14;break}return e.next=10,i.json();case 10:return s=e.sent,e.abrupt("return",{expirationDate:(new Date).getTime()+1e3*s.expires_in,accessToken:s.access_token,refreshToken:s.refresh_token});case 14:throw new Error(i.status+" in requestAccessToken!");case 15:e.next=18;break;case 17:throw new Error("Server-side authentication not implemented yet!");case 18:case"end":return e.stop()}}),e)}))),N.apply(this,arguments)}var V={requestAccessToken:U,requestAuthorizationToken:L},D={playlistRepository:$,authRepository:V},B={name:"LoginPage",methods:{login:function(){var e=Object(T["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,D.authRepository.requestAuthorizationToken(location.origin+this.$router.resolve({name:"authCallback"}).href,"/");case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},M=B,F=(n("21f1"),Object(l["a"])(M,E,O,!1,null,"52ffd79b",null)),q=F.exports,H=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"login-return"}},[!e.$store.getters.isAuthenticated&&e.isSuccess?[n("Spinner"),n("h2",[e._v("Authenticating...")])]:e.isSuccess?e._e():[n("h2",[e._v("Authentication failed!")]),n("router-link",{attrs:{to:"/"}},[n("button",{on:{click:function(t){return e.$router.push("/")}}},[e._v("Return to home")])])]],2)},Y=[],z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"spinner"}})},J=[],G={name:"Spinner"},K=G,W=(n("b41a"),Object(l["a"])(K,z,J,!1,null,"ce4c8f92",null)),X=W.exports,Q={name:"LoginReturn",data:function(){return{isSuccess:!0}},components:{Spinner:X},created:function(){var e=this;return Object(T["a"])(regeneratorRuntime.mark((function t(){var n,r,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$store.getters.isAuthenticated){t.next=3;break}return t.next=3,e.$router.push("/");case 3:if(n=e.$route.query,r=n.state,!(n.error||null==n.error&&null==n.code)){t.next=8;break}return e.isSuccess=!1,t.abrupt("return");case 8:return i=n.code,t.next=11,D.authRepository.requestAccessToken(location.origin+e.$router.resolve({name:"authCallback"}).href,i);case 11:if(s=t.sent,e.$store.commit("setSpotifyAccessToken",{accessToken:s.accessToken,expirationDate:s.expirationDate}),null==r){t.next=18;break}return t.next=16,e.$router.push(r);case 16:t.next=20;break;case 18:return t.next=20,e.$router.push("/");case 20:case"end":return t.stop()}}),t)})))()}},Z=Q,ee=(n("2531"),Object(l["a"])(Z,H,Y,!1,null,"4084ebe4",null)),te=ee.exports,ne=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"playlists"}},[n("ul",e._l(e.playlistItems,(function(e){return n("PlaylistCard",{key:e.id,attrs:{item:e}})})),1)])},re=[],ie=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:{selected:e.isPlaylistSelected},attrs:{id:"playlist-card"},on:{click:function(t){return e.onItemSelected(e.item)}}},[n("img",{attrs:{src:e.item.images[0].url,alt:e.item.name}}),n("span",{attrs:{id:"name"}},[e._v(e._s(e.item.name))]),n("span",{attrs:{id:"tracks"}},[e._v(e._s(e.item.tracks.total)+" tracks")]),n("button",{directives:[{name:"ripple",rawName:"v-ripple"}],on:{click:function(t){return t.stopPropagation(),e.onItemSelected(e.item)}}},[e._v(e._s(e.isPlaylistSelected?"Selected":"Select"))])])},se=[],ae={name:"PlaylistCard",props:{item:Object},methods:{onItemSelected:function(e){this.$store.commit("changeSelectPlaylistState",e)}},computed:{isPlaylistSelected:function(){return this.$store.getters.isPlaylistSelected(this.item.id)}}},oe=ae,ce=(n("4792"),Object(l["a"])(oe,ie,se,!1,null,"66932b32",null)),le=ce.exports,ue={name:"Playlists",components:{PlaylistCard:le},data:function(){return{playlistItems:[]}},created:function(){var e=this;return Object(T["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$store.commit("startLoading"),t.next=3,D.playlistRepository.getCurrentUserPlaylists();case 3:n=t.sent,e.$store.commit("finishLoading"),e.playlistItems=n.items;case 6:case"end":return t.stop()}}),t)})))()}},pe=ue,de=(n("b806"),Object(l["a"])(pe,ne,re,!1,null,"27003e4e",null)),fe=de.exports,me=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"workflow-container"}},[n("div",{attrs:{id:"progress"}},[e._v("stepper progress bar")]),n("div",{attrs:{id:"router-container"}},[n("router-view")],1),n("div",{attrs:{id:"menu"}},[n("em",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"material-icons",class:{enabled:e.isBackAllowed},on:{click:function(t){return e.workflowMoveSteps(-1)}}},[e._v("arrow_back")]),n("em",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"material-icons",class:{enabled:e.isForwardAllowed},on:{click:function(t){return e.workflowMoveSteps(1)}}},[e._v("arrow_forward")])])])},he=[],ve=(n("c975"),{name:"WorkflowContainer",computed:{isBackAllowed:function(){return S.indexOf(this.$store.state.route.name)>0},isForwardAllowed:function(){var e=this.$store.state.route.name,t=S.indexOf(e)<S.length-1,n=this.$store.getters.isStepValid(e);return t&&n}},methods:{workflowMoveSteps:function(e){if((!(e>0)||this.isForwardAllowed)&&(!(e<0)||this.isBackAllowed)){var t=S.indexOf(this.$router.currentRoute.name),n=Math.max(0,Math.min(S.length-1,t+e));n!==t&&this.$router.push({name:S[n]})}}}}),ye=ve,_e=(n("65f1"),Object(l["a"])(ye,me,he,!1,null,"194c9c52",null)),be=_e.exports,ge=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"analysis"}},e._l(20,(function(t){return n("Collapsible",{key:t,attrs:{title:"Trend"}},[n("h1",[e._v("Hallo "+e._s(t))])])})),1)},ke=[],we=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"collapsible"},on:{click:function(t){e.isCollapsed=!e.isCollapsed}}},[n("div",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{id:"bar"}},[n("span",[e._v(e._s(e.title))]),e.isCollapsed?n("em",{staticClass:"material-icons"},[e._v("expand_more")]):n("em",{staticClass:"material-icons"},[e._v("expand_less")])]),n("div",{class:{collapsed:e.isCollapsed},attrs:{id:"content"}},[e._t("default")],2)])},Se=[],Ae={name:"Collapsible",data:function(){return{isCollapsed:!0}},props:["title"]},Pe=Ae,xe=(n("a18f"),Object(l["a"])(Pe,we,Se,!1,null,"39c1cc1e",null)),Ee=xe.exports,Oe={name:"Analysis",components:{Collapsible:Ee}},Te=Oe,je=(n("9f55"),Object(l["a"])(Te,ge,ke,!1,null,"029a0924",null)),Ce=je.exports,Ie=n("31bd");r["a"].config.productionTip=!1,r["a"].use(i["a"]),r["a"].directive("ripple",d["a"]);var Re=[{path:"/",component:be,children:[{path:"",component:fe,name:S[0]},{path:"analysis",component:Ce,name:S[1]}]},{path:"/login",component:q,name:"login"},{path:"/authCallback",component:te,name:"authCallback"}],$e=new i["a"]({mode:"history",routes:Re});Object(Ie["sync"])(x,$e),$e.beforeEach((function(e,t,n){x.getters.isAuthenticated||"authCallback"===e.name||"login"===e.name?n():n("/login")})),new r["a"]({store:x,render:function(e){return e(p)},router:$e}).$mount("#app")},"5c0b":function(e,t,n){"use strict";var r=n("9c0c"),i=n.n(r);i.a},"65f1":function(e,t,n){"use strict";var r=n("a579"),i=n.n(r);i.a},"991a":function(e,t,n){},"9c0c":function(e,t,n){},"9e4c":function(e,t,n){},"9f55":function(e,t,n){"use strict";var r=n("3086"),i=n.n(r);i.a},a18f:function(e,t,n){"use strict";var r=n("c627"),i=n.n(r);i.a},a579:function(e,t,n){},b3a3:function(e,t,n){},b41a:function(e,t,n){"use strict";var r=n("991a"),i=n.n(r);i.a},b806:function(e,t,n){"use strict";var r=n("b3a3"),i=n.n(r);i.a},c627:function(e,t,n){},db73:function(e,t,n){}});
//# sourceMappingURL=app.32fdd5db.js.map